---
title: "LeetCode 594. Longest Harmonious Subsequence"
emoji: "ğŸ–‹"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["leetcode", "go"]
published: true
---
## ã¯ã˜ã‚ã«
LeetCode ã€Œ594. Longest Harmonious Subsequenceã€ã®å•é¡Œã‚’Goã§è§£ãã¾ã—ãŸã€‚

## å•é¡Œ
https://leetcode.com/problems/longest-harmonious-subsequence/description

### å•é¡Œæ–‡
We define a harmonious array as an array where the difference between its maximum value and its minimum value is exactly `1`.
Given an integer array `nums`, return the length of its longest harmonious subsequence* among all its possible subsequences.

*A subsequence is an array that can be derived from another array by deleting some or no elements without changing the order of the remaining elements.

**å’Œè¨³**
èª¿å’Œé…åˆ—ã¨ã¯ã€æœ€å¤§å€¤ã¨æœ€å°å€¤ã®å·®ãŒã¡ã‚‡ã†ã© `1` ã§ã‚ã‚‹é…åˆ—ã¨å®šç¾©ã—ã¾ã™ã€‚ 
æ•´æ•°é…åˆ— `nums` ãŒä¸ãˆã‚‰ã‚ŒãŸå ´åˆã€ãã®é…åˆ—ã«å«ã¾ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ã™ã¹ã¦ã®éƒ¨åˆ†åˆ—*ã®ä¸­ã§æœ€ã‚‚é•·ã„èª¿å’Œéƒ¨åˆ†åˆ—ã®é•·ã•ã‚’è¿”ã—ã¾ã™ã€‚

*éƒ¨åˆ†åˆ—ã¯ã€æ®‹ã‚Šã®è¦ç´ ã®é †åºã‚’å¤‰æ›´ã›ãšã«ã€ä¸€éƒ¨ã®è¦ç´ ã‚’å‰Šé™¤ã™ã‚‹ã‹ã€è¦ç´ ã‚’ã¾ã£ãŸãå‰Šé™¤ã—ãªã„ã“ã¨ã«ã‚ˆã£ã¦åˆ¥ã®é…åˆ—ã‹ã‚‰æ´¾ç”Ÿã§ãã‚‹é…åˆ—ã§ã™ã€‚

### ä¾‹
1.
```
Input: nums = [1,3,2,2,5,2,3,7]

Output: 5

Explanation:

The longest harmonious subsequence is [3,2,2,2,3].
```

2.
```
Input: nums = [1,2,3,4]

Output: 2

Explanation:

The longest harmonious subsequences are [1,2], [2,3], and [3,4], all of which have a length of 2.
```

3.
```
Input: nums = [1,1,1,1]

Output: 0

Explanation:

No harmonic subsequence exists.
```

### åˆ¶ç´„
- 1 <= nums.length <= 2 * 104
- -109 <= nums[i] <= 109

### å•é¡Œã®ç†è§£
- éƒ¨åˆ†åˆ— (subsequence): é †ç•ªã‚’å¤‰ãˆãšã«ä¸€éƒ¨ã®è¦ç´ ã‚’é¸ã¶ï¼ˆé€£ç¶šã—ã¦ã„ã‚‹å¿…è¦ã¯ãªã„ï¼‰
- èª¿å’Œã®ã¨ã‚ŒãŸéƒ¨åˆ†åˆ— (harmonious subsequence):
  - æœ€ã‚‚å¤§ãã„è¦ç´ ã¨æœ€ã‚‚å°ã•ã„è¦ç´ ã®å·®ãŒ ã¡ã‚‡ã†ã© 1
  - ãã®ä¸­ã§æœ€ã‚‚é•·ã„éƒ¨åˆ†åˆ—ã®é•·ã•ã‚’æ±‚ã‚ã‚‹

## è§£ç­”1ï¼ˆã‚½ãƒ¼ãƒˆãƒ»Two Pointersï¼‰
èª¿å’Œã®ã¨ã‚ŒãŸéƒ¨åˆ†åˆ—ã‚’ä½œã‚‹ãŸã‚ã«ã¯ã€ã‚ã‚‹æ•°xã¨x+1ã®ãƒšã‚¢ã‚’é¸ã¶å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ä¾‹1`[1,3,2,2,5,2,3,7]`ã ã¨2ã¨3ã®ãƒšã‚¢ãŒé¸ã°ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ãŒã€
ã‚½ãƒ¼ãƒˆã™ã‚‹ã¨`[1 2 2 2 3 3 5 7]`ã¨ãªã‚Šã€ã‚ã‚‹æ•°xã¨x+1ã®ãƒšã‚¢ã®æœ€å¤§æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ã‚„ã™ã„ã§ã™ã€‚

### ã‚³ãƒ¼ãƒ‰
```go
func findLHS(nums []int) int {
    // é…åˆ—ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹
    slices.Sort(nums)

    maxLen := 0
    left := 0

    for right := 1; right < len(nums); right++ {
        // å·®ãŒ1ã‚ˆã‚Šå¤§ãããªã£ãŸã‚‰leftã‚’èª¿æ•´
        for nums[right]-nums[left] > 1 {
            left++
        }
        // èª¿å’Œã®ã¨ã‚ŒãŸéƒ¨åˆ†åˆ—ã§ã‚ã‚‹ã‹ç¢ºèª
        if nums[right]-nums[left] == 1 {
            maxLen = max(maxLen, right-left+1)
        }
    }

    return maxLen
}

// æœ€å¤§å€¤ã‚’æ±‚ã‚ã‚‹é–¢æ•°
func max(a int, b int) int {
    if a > b {
        return a
    }
    return b
}
```
foræ–‡ã§ã¯ã€Two Pointers ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã£ã¦éƒ¨åˆ†åˆ—ã®é•·ã•ã‚’æ±‚ã‚ã¦ã„ã¾ã™ã€‚

Two Pointersã‚’ä½¿ç”¨ã—ãŸå•é¡Œã¯ã€ä»¥ä¸‹ã®è¨˜äº‹ã§ã‚‚æ‰±ã£ã¦ã„ã¾ã™ã®ã§å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚
- [LeetCode 2824. Count Pairs Whose Sum is Less than Target](https://zenn.dev/shimpo/articles/leet-code-2824-20250315)

### è¨ˆç®—é‡
- æ™‚é–“çš„è¨ˆç®—é‡ï¼šO(n log n)
    - ã‚½ãƒ¼ãƒˆ: O(n log n) 
    - Two Pointers: O(n) 
- ç©ºé–“çš„è¨ˆç®—é‡ï¼šO(1)

## è§£ç­”2ï¼ˆHashMapï¼‰
ä»–ã«ã‚‚ã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒã‚ã£ãŸã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚
HashMapã‚’ä½¿ã„ã€ãã‚Œãã‚Œã®æ•°å€¤ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ã€ã‚ã‚‹æ•°xã¨x+1ã®æœ€å¤§æ•°ã‚’æ±‚ã‚ã‚‹æ–¹æ³•ã§ã™ã€‚

### ã‚³ãƒ¼ãƒ‰
```go
func findLHS(nums []int) int {
    // æ•°å€¤ã®å‡ºç¾å›æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
    freqMap := make(map[int]int)
    for _, v := range nums {
        freqMap[v]++
    }

    maxLen := 0

    // å„ã‚­ãƒ¼ x ã«å¯¾ã—ã¦ x+1 ã®å­˜åœ¨ã‚’ç¢ºèªã—ã€æœ€å¤§é•·ã‚’æ›´æ–°
    for key, count := range freqMap {
        // key+1 ãŒå­˜åœ¨ã™ã‚‹å ´åˆã®ã¿è¨ˆç®—
        if nextVal, exists := freqMap[key+1]; exists {
            maxLen = max(maxLen, count+nextVal)
        }
    }

    return maxLen
}

// æœ€å¤§å€¤ã‚’æ±‚ã‚ã‚‹é–¢æ•°
func max(a int, b int) int {
    if a > b {
        return a
    }
    return b
}
```
ã¾ãšã€ãƒãƒƒãƒ— (`map[int]int`) ã‚’ä½¿ã£ã¦å„æ•°å­—ã®å‡ºç¾å›æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ã¾ã™ã€‚
ãã®å¾Œã€key ã¨ key+1 ã®ãƒšã‚¢ã‚’æ¢ã—ã€æœ€å¤§é•·ã‚’æ›´æ–°ã—ã¦ã„ã¾ã™ã€‚

### è¨ˆç®—é‡
- æ™‚é–“çš„è¨ˆç®—é‡ï¼šO(n)
- ç©ºé–“çš„è¨ˆç®—é‡ï¼šO(n)