---
title: "LeetCode 222. Count Complete Tree Nodes"
emoji: "ğŸ–‹"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["leetcode", "go"]
published: true
---
## ã¯ã˜ã‚ã«
LeetCode ã€Œ222. Count Complete Tree Nodesã€ã®å•é¡Œã‚’Goã§è§£ãã¾ã—ãŸã€‚

## å•é¡Œ
https://leetcode.com/problems/count-complete-tree-nodes/description/

### å•é¡Œæ–‡
Given the `root` of a complete binary tree, return the number of the nodes in the tree.

According to Wikipedia, every level, except possibly the last, is completely filled in a complete binary tree, and all nodes in the last level are as far left as possible. It can have between `1` and `2h` nodes inclusive at the last level `h`.

Design an algorithm that runs in less than `O(n)` time complexity.

**å’Œè¨³**
å®Œå…¨äºŒåˆ†æœ¨ã®ãƒ«ãƒ¼ãƒˆãŒä¸ãˆã‚‰ã‚ŒãŸã¨ãã€ãã®æœ¨ã®ãƒãƒ¼ãƒ‰ã®æ•°ã‚’è¿”ã™ã€‚

ã‚¦ã‚£ã‚­ãƒšãƒ‡ã‚£ã‚¢ã«ã‚ˆã‚‹ã¨ã€å®Œå…¨äºŒåˆ†æœ¨ã§ã¯æœ€å¾Œã®ãƒ¬ãƒ™ãƒ«ã‚’é™¤ãã™ã¹ã¦ã®ãƒ¬ãƒ™ãƒ«ãŒå®Œå…¨ã«åŸ‹ã¾ã‚Šã€æœ€å¾Œã®ãƒ¬ãƒ™ãƒ«ã®ã™ã¹ã¦ã®ãƒãƒ¼ãƒ‰ã¯å¯èƒ½ãªé™ã‚Šå·¦ã«ã‚ã‚‹ã€‚æœ€å¾Œã®ãƒ¬ãƒ™ãƒ«hã«å«ã¾ã‚Œã‚‹ãƒãƒ¼ãƒ‰ã¯1ï½2hã§ã‚ã‚‹ã€‚

O(n)æœªæº€ã®æ™‚é–“è¤‡é›‘åº¦ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’è¨­è¨ˆã›ã‚ˆã€‚

### ä¾‹
1.

```
         1          
      /     \        
     2       3    
   /  \      /     
  4    5   6   
```

```
Input: root = [1,2,3,4,5,6]
Output: 6
```

2.
```
Input: root = []
Output: 0
```

3.
```
Input: root = [1]
Output: 1
```

### åˆ¶ç´„
- The number of nodes in the tree is in the range [0, 5 * 104].
- 0 <= Node.val <= 5 * 104
- The tree is guaranteed to be complete.

## è§£ç­”
å®Œå…¨äºŒåˆ†æœ¨ã®ãƒãƒ¼ãƒ‰æ•°ã‚’æ±‚ã‚ã‚‹å•é¡Œã§ã™ã€‚
å®Œå…¨äºŒåˆ†æœ¨ã¨ã„ã†å‰æãŒãªã‘ã‚Œã°ã€DFSã§ä»¥ä¸‹ã®ã‚ˆã†ã«æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

#### ã‚³ãƒ¼ãƒ‰
```go
func countNodes(root *TreeNode) int {
    if root == nil {
        return 0
    }

    return countNodes(root.Left) + countNodes(root.Right) + 1
}
```
ã“ã®å®Ÿè£…ã ã¨ã€å…¨ã¦ã®ãƒãƒ¼ãƒ‰ã‚’ãŸã©ã‚‹ã“ã¨ã«ãªã‚Šã€æ™‚é–“çš„è¨ˆç®—é‡ã¯O(n)ã¨ãªã‚Šã¾ã™ã€‚
ä»Šå›ã®å•é¡Œã¯ã€æ™‚é–“çš„è¨ˆç®—é‡ã‚’O(n)æœªæº€ã§æ±‚ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€å®Œå…¨äºŒåˆ†æœ¨ã®ç‰¹å¾´ã‚’æ´»ã‹ã—ã€åŠ¹ç‡çš„ã«æ±‚ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### å®Œå…¨äºŒåˆ†æœ¨
å®Œå…¨äºŒåˆ†æœ¨ã¯æœ€ä¸‹å±¤ä»¥å¤–ã¯å…¨ã¦ã®å±¤ãŒåŸ‹ã¾ã£ã¦ãŠã‚Šã€æœ€ä¸‹å±¤ã¯å·¦è©°ã¨ãªã£ã¦ã„ã¾ã™ã€‚
ãã®ãŸã‚ã€å·¦å³ã®é«˜ã•ãŒåŒã˜ã§ã‚ã‚Œã°ã€å·¦éƒ¨åˆ†æœ¨ã¯**å®Œå…¨ã«åŸ‹ã¾ã£ã¦ã„ã‚‹å®Œå…¨äºŒåˆ†æœ¨**ã¨è¨€ãˆã¾ã™ã€‚
å®Œå…¨ã«åŸ‹ã¾ã£ãŸé«˜ã• h ã®å®Œå…¨äºŒåˆ†æœ¨ã®ãƒãƒ¼ãƒ‰æ•°ã¯ `2^h - 1` ã§ã™ã€‚
ãŸã¨ãˆã°ã€é«˜ã•ãŒ3ãªã‚‰ **2^3 - 1 = 7** ãƒãƒ¼ãƒ‰ã¨ãªã‚Šã¾ã™ã€‚

ã¾ãŸã€å·¦å³ã®é«˜ã•ãŒé•ã†å ´åˆã€å³éƒ¨åˆ†ã¯1ã¤ä½ã„çŠ¶æ…‹ã§ã™ã€‚
ãã®å ´åˆã€å³éƒ¨åˆ†æœ¨ã¯å®Œå…¨ã«åŸ‹ã¾ã£ã¦ã„ã‚‹å®Œå…¨äºŒåˆ†æœ¨ã¨ãªã‚Šã¾ã™ã€‚

### ã‚³ãƒ¼ãƒ‰
```go
func countNodes(root *TreeNode) int {
    if root == nil {
        return 0
    }

    leftDepth := getDepth(root.Left)
    rightDepth := getDepth(root.Right)

    if leftDepth == rightDepth {
        return (1 << leftDepth) + countNodes(root.Right)
    } else {
        return (1 << rightDepth) + countNodes(root.Left)
    }
}

func getDepth(node *TreeNode) int {
    depth := 0
    for node != nil {
        depth++
        node = node.Left
    }
    return depth

}
```
`(1 << leftDepth)`ã®éƒ¨åˆ†ã¯ã€å·¦éƒ¨åˆ†æœ¨ã®ãƒãƒ¼ãƒ‰æ•°ã«ãƒ«ãƒ¼ãƒˆãƒãƒ¼ãƒ‰ã‚’åˆã‚ã›ãŸæ•°ã‚’è¨ˆç®—ã—ã¦ã„ã¾ã™ã€‚
`a << n`ã¯ `a Ã— 2^nï¼ˆ2ã®ç´¯ä¹—ï¼‰`ã¨ã„ã†æ„å‘³ã«ãªã‚Šã¾ã™ã€‚

`leftDepth == rightDepth`ã®å ´åˆã€
å·¦éƒ¨åˆ†æœ¨ã¯é«˜ã•leftDepthã®å®Œå…¨äºŒåˆ†æœ¨ã§ã€`2^leftDepth - 1`ã®ãƒãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã™ã€‚
ãƒ«ãƒ¼ãƒˆã‚’åˆã‚ã›ã‚‹ã¨`2^leftDepth`å€‹ã«ãªã‚‹ãŸã‚ã€æ®‹ã‚Šã®å³éƒ¨åˆ†ãã«å¯¾ã—ã¦å†å¸°çš„ã«`countNodes` ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚

## å‚è€ƒ
äºŒåˆ†æœ¨ã®å•é¡Œã¯ã€ä»¥ä¸‹ã®è¨˜äº‹ã§ã‚‚ç´¹ä»‹ã—ã¦ã„ã¾ã™ã®ã§ã€å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚
- [LeetCode 100. Same Tree](https://zenn.dev/shimpo/articles/leet-code-100-20250608)
- [LeetCode 104. Maximum Depth of Binary Tree](https://zenn.dev/shimpo/articles/leet-code-104-20250607)
- [LeetCode 226. Invert Binary Tree](https://zenn.dev/shimpo/articles/leet-code-226-20250610)
- [LeetCode 101. Symmetric Tree](https://zenn.dev/shimpo/articles/leet-code-101-20250611)
- [LeetCode 112. Path Sum](https://zenn.dev/shimpo/articles/leet-code-112-20250615)